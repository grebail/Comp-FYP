<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Administration</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
            color: #333;
        }

        header {
            background: linear-gradient(to right, #1565c0, #1e88e5);
            color: #fff;
            padding: 20px;
            text-align: center;
            border-bottom: 5px solid #388e3c;
        }

        form {
            background-color: white;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }

        label {
            display: block;
            margin: 10px 0 5px;
        }

        input,
        select,
        button {
            width: 100%;
            padding: 8px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        button {
            background-color: #2196F3;
            color: white;
            cursor: pointer;
        }

        button:hover {
            background-color: #1976D2;
        }
    </style>
</head>

<body>
    <header>
        <h1>Book Administration</h1>
    </header>

    <main>
        <section>
            <h2>Add New Copy</h2>
            <form id="addBookForm">
                <label for="isbn">ISBN:</label>
                <input type="text" id="isbn" name="isbn" required>

                <label for="title">Title:</label>
                <input type="text" id="title" name="title" required>

                <label for="authors">Authors (comma-separated):</label>
                <input type="text" id="authors" name="authors" required>

                <label for="publishedDate">Published Date:</label>
                <input type="date" id="publishedDate" name="publishedDate" required>

                <label for="category">Category:</label>
                <select id="category" name="category" required>
                    <option value="Juvenile Fiction">Juvenile Fiction</option>
                    <option value="Science">Science</option>
                    <option value="History">History</option>
                    <!-- Add more categories as needed -->
                </select>

                <label for="bookLocation">Book Location:</label>
                <select id="bookLocation" name="bookLocation" required>
                    <option value="Stanley Ho Library">Stanley Ho Library</option>
                    <option value="Ho Sik Yee Library">Ho Sik Yee Library</option>
                </select>

                <label for="locationId">Location ID (LCC Code):</label>
                <input type="text" id="locationId" name="locationId" required placeholder="Automatically Generated" readonly>

                <label for="availability">Availability:</label>
                <input type="checkbox" id="availability" name="availability" checked>

                <label for="noOfCopy">Number of Copies:</label>
                <input type="number" id="noOfCopy" name="noOfCopy" min="1" required>

                <button type="submit">Add Copy</button>
            </form>
        </section>
    </main>

    <script>
        // Mapping for LCC codes based on category type
        const lccCodes = {
            "Juvenile Fiction": "F 615",
            "Science": "Q 175",
            "History": "D 16",
            // Add more categories and their respective LCC codes here
        };

        // Function to generate the location ID
        function generateLocationId(title, authors, publishedDate, category, copyNumber) {
            // Get the LCC code for the category
            const lccCode = lccCodes[category] || "UNKNOWN";

            // Get the first two letters of the title, padded with "XX" if too short
            const titleCode = title.substring(0, 2).toUpperCase().padEnd(2, "X");

            // Get the first two letters of the author's given name, padded with "XX" if too short
            const authorCode = authors.length > 0
                ? authors[0].substring(0, 2).toUpperCase().padEnd(2, "X")
                : "XX";

            // Extract the year from the published date
            const year = new Date(publishedDate).getFullYear();

            // Format the copy number with leading zeros (e.g., 01, 02, etc.)
            const formattedCopyNumber = String(copyNumber).padStart(2, "0");

            // Combine everything into the location ID
            return `${lccCode} ${titleCode} ${authorCode} ${year} .${formattedCopyNumber}`;
        }

        // Event listener to auto-generate location IDs
        $('#isbn, #title, #authors, #publishedDate, #category, #noOfCopy').on('change keyup', function () {
            const title = $('#title').val();
            const authors = $('#authors').val().split(',').map(a => a.trim()); // Split authors by commas
            const publishedDate = $('#publishedDate').val();
            const category = $('#category').val();
            const copyNumber = 1; // Assuming only one copy is generated for simplicity

            if (title && authors.length > 0 && publishedDate && category) {
                const locationId = generateLocationId(title, authors, publishedDate, category, copyNumber);
                $('#locationId').val(locationId); // Update the locationId input field
            }
        });
    </script>
</body>

</html>